<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Informatics.Appetite.Pages.RecipeDetailsPage"
             Title="Recipe Details"
             BackgroundColor="White">
    <ScrollView>
        <VerticalStackLayout Spacing="15" Padding="20">
            <!-- Recipe Name -->
            <Label Text="{Binding Recipe.Name, Mode=TwoWay}"
                   FontAttributes="Bold"
                   FontSize="48"
                   TextColor="Black"
                   Margin="0,0,0,10"/>
            
            <!-- Vertical Layout for Description and Details -->
            <VerticalStackLayout Spacing="40">
                <!-- Recipe Description -->
                <Label Text="These are placeholder sentences for the recipe description. This is where we briefly describe how tasty this dish is (without telling some long-winded story about how grandma used to make this when we were sick as a child). If you see this, please tell Erik to implement the binding for recipe details. Bon appetit!"
                       FontAttributes="Bold"
                       FontSize="18"
                       TextColor="Black"
                       HorizontalOptions="Fill"
                       VerticalOptions="Start"
                       LineBreakMode="WordWrap"/>
                
                <!-- Grid for Difficulty, Cooking Time, and Servings -->
                <Grid ColumnDefinitions="*,*,*" HorizontalOptions="Fill">
                    <!-- Difficulty -->
                    <VerticalStackLayout Spacing="5" HorizontalOptions="Center" Grid.Column="0">
                        <Image Source="hat_chef.png" WidthRequest="40" HeightRequest="40" HorizontalOptions="Center"/>
                        <Label Text="{Binding Recipe.DifficultyLevel}"
                            FontSize="18"
                            TextColor="Black"
                            HorizontalOptions="Center"/>
                    </VerticalStackLayout>

                    <!-- Cooking Time -->
                    <VerticalStackLayout Spacing="5" HorizontalOptions="Center" Grid.Column="1">
                        <Image Source="clock_three.png" WidthRequest="40" HeightRequest="40" HorizontalOptions="Center"/>
                        <Label Text="{Binding Recipe.CookingTime, StringFormat ='{0} minutes'}"
                            FontSize="18"
                            TextColor="Black"
                            HorizontalOptions="Center"/>
                    </VerticalStackLayout>

                    <!-- Servings -->
                    <VerticalStackLayout Spacing="5" HorizontalOptions="Center" Grid.Column="2">
                        <Image Source="plate_utensils.png" WidthRequest="40" HeightRequest="40" HorizontalOptions="Center"/>
                        <Label Text="{Binding Recipe.Servings, StringFormat='{0} portions'}"
                            FontSize="18"
                            TextColor="Black"
                            HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </Grid>
            </VerticalStackLayout>

            <!-- Grid for Ingredients and Cooking Instructions -->
            <Grid ColumnDefinitions="*,*">
                <!-- Ingredient List (Read-Only) -->
                <VerticalStackLayout Spacing="15" Padding="10" Grid.Column="0">
                    <Label Text="Ingredients"
                           FontAttributes="Bold"
                           FontSize="24"
                           TextColor="Black"/>
                    <CollectionView ItemsSource="{Binding Ingredients}"
                                    SelectionMode="None"
                                    VerticalOptions="Fill"
                                    ItemsUpdatingScrollMode="KeepItemsInView">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Border Stroke="#E0E0E0" StrokeThickness="1" Padding="10" Margin="5">
                                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto">
                                        <Label Grid.Row="0" Grid.Column="0"
                                               Text="{Binding Name}"
                                               FontAttributes="Bold"
                                               FontSize="16"
                                               TextColor="Black"/>
                                        <Label Grid.Row="0" Grid.Column="1"
                                               Text="{Binding Quantity, StringFormat='Quantity: {0}'}"
                                               FontSize="14"
                                               TextColor="Gray"
                                               HorizontalOptions="End"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>

                        <!-- Empty View -->
                        <CollectionView.EmptyView>
                            <Label Text="No ingredients found in this recipe."
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"
                                   FontSize="14"
                                   FontAttributes="Italic"
                                   TextColor="Gray"/>
                        </CollectionView.EmptyView>
                    </CollectionView>
                </VerticalStackLayout>

                <!-- Cooking Instructions -->
                <VerticalStackLayout Spacing="15" Padding="10" Grid.Column="1">
                    <Label Text="Cooking Instructions"
                           FontAttributes="Bold"
                           FontSize="24"
                           TextColor="Black"/>
                    <Label Text="1. This is a placeholder instruction.&#x0a;2. This is another placeholder instruction.&#x0a;3. Implement this properly when the Recipe entity in the database has the new 'data' attribute with description and instruction as JSON.&#x0a;4. This should be a list, not a string with line breaks."
                           FontSize="16"
                           TextColor="Black"
                           LineBreakMode="WordWrap"/>
                </VerticalStackLayout>
            </Grid>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>